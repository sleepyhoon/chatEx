## 2024/07/02
이제 채팅은 구현이 완료했음.
`localhost`에 존재하는 redis를 사용해서 구현함.
이제 유저를 만들어서 해당 채팅방 내에 유저도 존재하게 구현해야함.
메세지도 해당 채팅방과 관계를 맺도록 설정하는 것도 생각해야할듯.
유저는 redis가 아니라 mysql에 저장하는 방식으로 진행할 생각임.
---
## 2024/07/03
### MySQL에 유저를 저장하다. 
일단 유저를 만들어서 해당 채팅방 내에 유저가 존재하게 했음.(정확히 말하면 유저가 존재하는건 아니고, 해당 `roomId`를 가진 유저를 출력하게 구현
하고 싶음) 일단 유저를 mysql에 저장하도록 하였음. 현재 문제점은
- 현재 유저 목록을 보았을 때 채팅방을 나갔다가 들어올 때 마다 목록이 증가해서 보임.
![img.png](img.png)
- 그리고 해당 `roomId`를 가지는 유저를 출력해야하는데 사진처럼 출력이 안됨. 실제로 mysql에서는 `roomId`가 저장이 되어 있기 때문에 잘 되야 한다고 생각하는데 좀 처럼 안되고 있음.
---
### 2024/07/04
### SockJS
SockJS은 내가 크롬 웹브라우저 상에서 채팅을 구현할 때 사용하는 것이었고, 실제 모바일 앱과 통신할 때는 필요가 없는 듯하다. 그래서 사용하지 않는게 나을 듯하다.
Websocket을 이용해서 구현하고자 하였다.
### ErrorHandler
소소하지만 에러를 관리하기 위해 `GloberExceptionHandler`를 구현했다. 아직 2개의 에러만 구현했고 기타 나머지도 구현을 하면 좋을듯.
### ListOperation
채팅 역시 redis에 저장하고 있는데, 내 생각에 채팅은 `HashOperation`으로 저장하면 채팅 내용이 보이지 않아 문제가 되는 것 같았다. 그래서 `ListOperation`으로 변경해보았다.

---
## 2024/07/06
### 채팅 로그를 구현하자.
- 채팅 메세지 자체를 저장하는 것보다 채팅 로그를 작성한 후, 이것을 저장하는게 합리적이라고 생각이 들었다. 그래서
redis를 캐시로 사용하고, minIO를 기본 DB로 사용해 볼 생각이다.
- redis를 캐시로 사용하기 위해 3일 동안만 데이터를 저장하게 설정하였다.
기본적인 자료 수집을 거쳐보았고, 이제 기존에 채팅 메세지가 아니라 채팅 로그를 저장하도록 service 단 코드를 수정해야 한다. 
- 채팅 로그를 저장한다면, 이를 다시 읽어와서 parsing 해서 채팅 메세지를 다시 채팅방에서 불러 읽을 수 있어야 한다.
이 기능을 구현해보도록 하자.